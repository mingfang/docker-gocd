
<!doctype html>

<html xmlns = 'http://www.w3.org/1999/xhtml' xml:lang = 'en' lang = 'en'>
<head>
<meta http-equiv = 'Content-Type' content = 'text/html; charset=UTF-8'></meta>

<meta name = 'google-site-verification' content = 'ALfMTxdH04YK-7c9mgrjLTkrOP55XqZtXqFk1dqCB4M'></meta>

<title>Agent API</title>

<link href = 'resources/stylesheets/help.css' media = 'screen' rel = 'Stylesheet' type = 'text/css'></link>

<link href = '//assets.zendesk.com/external/zenbox/v2.5/zenbox.css' media = 'screen, projection' rel = 'Stylesheet' type = 'text/css'></link>

<link href = 'resources/stylesheets/help_search.css' media = 'screen' rel = 'Stylesheet' type = 'text/css'></link>

<script src = '//www.google.com/jsapi' type = 'text/javascript'></script>

<link href = '/go/images/cruise.ico' rel = 'shortcut icon'></link>

<script src = 'resources/javascript/prototype.js' type = 'text/javascript'></script>

<script src = '//assets.zendesk.com/external/zenbox/v2.5/zenbox.js' type = 'text/javascript'></script>

<script src = 'resources/javascript/help.js' type = 'text/javascript'></script>

<script src = 'resources/javascript/help_search.js' type = 'text/javascript'></script>
</head>

<body>
<div id = 'hd'>
<h1>Help documentation
<div id = 'go_help_search'></div>
</h1>
</div>

<div class = 'block-content'>
            <script type="text/javascript">
               if (typeof(Zenbox) !== "undefined") {
                  Zenbox.init({
                    dropboxID:   "20094116",
                    url:         "http://twstudios.zendesk.com",
                    tabID:       "Help",
                    tabColor:    "black",
                    tabPosition: "Right"
                  });
             }
            </script>
          </div>

<div id = 'main-container'>
<div id = 'search_results_container'>
<div class = 'action-bar' inner_wrapper_class = 'action-bar-inner-wrapper'>
<div class = 'action-bar-inner-wrapper'>
<a id = 'hide_search_results'>&nbsp;</a>
</div>
</div>

<div id = 'branding'></div>

<div id = 'search_results'></div>
</div>

<div id = 'main'>
<div class = 'topic'>
<h2 onclick = 'toggleCollapse($(this));' class = 'collapsible-heading'>Agent API</h2>

<div class = 'content-container'>
<p>A collection of APIs to get information and do operations on agents. They allow Go administrators to provision and de-provision agents without needing to use the web interface.</p>

<div class = 'section'>
<h3 onclick = 'toggleCollapse($(this));' class = 'collapsible-heading'>List Agents</h3>

<div class = 'content-container'>
<div class = 'subsection'>
<h4 onclick = 'toggleCollapse($(this));' class = 'collapsible-heading'>Key</h4>

<div class = 'content-container'>
<table>
<caption>Parameters</caption>

<tr class = 'table-header'>
<th>URL format</th>

<th>HTTP Verb</th>

<th>Data</th>

<th>Explanation</th>
</tr>

<tr class = 'odd'>
<td>http://[server]/go/api/agents</td>

<th>GET</th>

<td>no parameters</td>

<td>List all the agents of the Go Server in JSON format along with the their information.
                    </td>
</tr>
</table>

<p> The following information about each of the agents is returned in the JSON response:
                
<ul>
<li>uuid</li>

<li>buildLocator</li>

<li>agent_name: (Maps to "Agent Name" column of Agents tab)</li>

<li>ipAddress: (Maps to "IP Address" column of Agents tab)</li>

<li>status: (Maps to "Status" column of Agents tab)</li>

<li>sandbox: (Maps to "Sandbox" column of Agents tab)</li>

<li>os: (Maps to "OS" column of Agents tab)</li>

<li>free_space: (Maps to "Free Space" column of Agents tab)</li>

<li>resources: [] (Maps to "Resources" column of Agents tab)</li>

<li>environments: [] (Maps to "Environments" column of Agents tab)</li>
</ul>
</p>
</div>
</div>
</div>
</div>

<div class = 'section'>
<h3 onclick = 'toggleCollapse($(this));' class = 'collapsed-heading'>Enable and Disable Agent</h3>

<div class = 'content-container collapsed'>
<div class = 'subsection'>
<h4 onclick = 'toggleCollapse($(this));' class = 'collapsible-heading'>Key</h4>

<div class = 'content-container'>
<table>
<caption>Parameters</caption>

<tr class = 'table-header'>
<th>URL format</th>

<th>HTTP Verb</th>

<th>Data</th>

<th>Explanation</th>
</tr>

<tr class = 'odd'>
<td>http://[server]/go/api/agents/[agent-uuid]/enable</td>

<th>POST</th>

<td>no parameters</td>

<td>Enable a disabled agent. Approve a pending agent.</td>
</tr>

<tr class = 'odd'>
<td>http://[server]/go/api/agents/[agent-uuid]/disable</td>

<th>POST</th>

<td>no parameters</td>

<td>Disable an enabled/pending agent.</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<div class = 'section'>
<h3 onclick = 'toggleCollapse($(this));' class = 'collapsed-heading'>Delete Agent</h3>

<div class = 'content-container collapsed'>
<div class = 'subsection'>
<h4 onclick = 'toggleCollapse($(this));' class = 'collapsible-heading'>Key</h4>

<div class = 'content-container'>
<table>
<caption>Parameters</caption>

<tr class = 'table-header'>
<th>URL format</th>

<th>HTTP Verb</th>

<th>Data</th>

<th>Explanation</th>
</tr>

<tr class = 'odd'>
<td>http://[server]/go/api/agents/[agent-uuid]/delete</td>

<th>POST</th>

<td>no parameters</td>

<td>Delete a disabled agent. Note that the agent will not be deleted unless it is in disabled state and is not building any job</td>
</tr>
</table>
</div>
</div>

<div class = 'subsection'>
<h4 onclick = 'toggleCollapse($(this));' class = 'collapsible-heading'>Response Codes</h4>

<div class = 'content-container'>
<table>
<tr class = 'table-header'>
<th>HTTP response code</th>

<th>Explanation</th>
</tr>

<tr class = 'odd'>
<th>200</th>

<td>Agent deleted successfully</td>
</tr>

<tr class = 'odd'>
<th>404</th>

<td>Agent with [uuid] does not exist</td>
</tr>

<tr class = 'odd'>
<th>406</th>

<td>Agent is not 'Disabled' or is still 'Building' or 'Cancelled'</td>
</tr>

<tr class = 'odd'>
<th>401</th>

<td>User does not have operate permission to delete agent</td>
</tr>

<tr class = 'odd'>
<th>500</th>

<td>An internal server error occurred</td>
</tr>
</table>
</div>
</div>

      <div class="note-box" style="padding: 0px 0pt 0pt">
    	  <div class="ab-bg">
      		<span class="ab-corner lvl1"></span>
      		<span class="ab-corner lvl2"></span>
      		<span class="ab-corner lvl3"></span>
      		<span class="ab-corner lvl4"></span>
      	</div>
      	<div class="box-content">
    
<p class = 'box'>
<p>
<strong>A note on deleting agents</strong>
</p>

<p>An agent continually contacts the Go server so long as it is running. If it is deleted from Go server, the next time it contacts Go server, Go will add it back to the list of agents.
                Normally you do not want this to happen. Follow the steps below to achieve this.
            </p>

<ul>
<li>Use the list agents API and keep checking the status of the agent that you want to delete till it shows Idle</li>

<li>Use the disable agent API to disable the agent, using the UUID available from the list agent API</li>

<li>Stop the Go agent service, manually or through a script. This is to prevent the agent from contacting the server again. You need to do this within 5 seconds of the disable agent
                    API
                </li>

<li>Use the delete agents API to delete the agent</li>
</ul>
</p>
	
        </div>
    	  <div class="ab-bg">
      		<span class="ab-corner lvl4"></span>
      		<span class="ab-corner lvl3"></span>
      		<span class="ab-corner lvl2"></span>
      		<span class="ab-corner lvl1"></span>
      	</div>
      </div>
    </div>
</div>

<div class = 'section'>
<h3 onclick = 'toggleCollapse($(this));' class = 'collapsed-heading'>Examples</h3>

<div class = 'content-container collapsed'>
<ul>
<li>We use curl, a command line tool for transferring files with URL syntax, in the following examples. Of course, you can use any HTTP client library.</li>

<li>We assume that the URL of the Go server is
<strong>http://goserver.com:8153/</strong>
.
            </li>

<li>We assume security has been switched on, and that there is a user named
                
<strong>jez</strong>

                with the password
<strong>badger</strong>
.
            </li>
</ul>

<p>The configuration with agents like this:</p>

<pre class = 'code'>
        &lt;cruise>
        ....
          &lt;agents>
            &lt;agent hostname="agent-machine1" ipaddress="10.38.10.7" uuid="e4d86ae7-7b7d-4bb9-9b3e-876c06d01605" isDenied="true">
              &lt;resources>
                &lt;resource>twist&lt;/resource>
                &lt;resource>windows&lt;/resource>
              &lt;/resources>
            &lt;/agent>
            &lt;agent hostname="agent-machine2" ipaddress="10.2.12.26" uuid="bf0e5682-51ad-4183-8776-b13491cf2f59">
              &lt;resources>
                &lt;resource>ec2&lt;/resource>
              &lt;/resources>
            &lt;/agent>
            &lt;agent hostname="agent-machine3" ipaddress="10.2.12.26" uuid="259f7a6b-f386-4d10-bee3-28997678c05c"/>
            &lt;agent hostname="agent-machine3" ipaddress="10.18.3.152" uuid="098d4904-0533-4160-8c92-077849cd52df" />
            &lt;agent hostname="agent-machine4" ipaddress="10.18.3.153" uuid="31aea908-717a-435c-ad04-96dcc8d941df" isDisabled="true">
          &lt;/agents>
        &lt;/cruise>
        </pre>

<p>If you want to get all agents' information</p>

<pre class = 'code'>curl -u jez:badger http://goserver.com:8153/go/api/agents</pre>

<p>If you want to enable agent on 'agent-machine1'</p>

<pre class = 'code'>curl -u jez:badger -d "" http://goserver.com:8153/go/api/agents/e4d86ae7-7b7d-4bb9-9b3e-876c06d01605/enable</pre>

<p>If you want to disable agent on 'agent-machine2'</p>

<pre class = 'code'>curl -u jez:badger -d "" http://goserver.com:8153/go/api/agents/bf0e5682-51ad-4183-8776-b13491cf2f59/disable</pre>

<p>If you want to delete agent on 'agent-machine4'</p>

<pre class = 'code'>curl -u jez:badger -d "" http://goserver.com:8153/go/api/agents/31aea908-717a-435c-ad04-96dcc8d941df/delete</pre>
</div>
</div>
</div>
</div>
</div>
</div>

<div id = 'no_result_message' class = 'error-box' style = 'display:none;'>
<div class = 'box-content'>
<div class = 'box'>Your search 
<span class = 'search_term'></span>
did not match any help pages.</div>
</div>
</div>

<div id = 'nav'>
<ul class = 'toc'>
<li>
<a href = 'welcome_to_go.html' class = 'current'>Welcome to Go</a>

<ul>
<li>
<a href = 'whats_new_in_go.html'>What's new in Go</a>
</li>

<li>
<a href = 'concepts_in_go.html'>Concepts in Go</a>
</li>
</ul>
</li>

<li>
<div>Installing Go</div>

<ul>
<li>
<a href = 'system_requirements.html'>System requirements</a>
</li>

<li>
<a href = 'installing_go_server.html'>Installing Go server</a>
</li>

<li>
<a href = 'installing_go_agent.html'>Installing Go agent</a>
</li>

<li>
<a href = 'run_go_without_install.html'>Running Go without installation</a>
</li>

<li>
<a href = 'upgrading_go.html'>Upgrading Go</a>
</li>

<li>
<a href = 'configuring_server_details.html'>Configuring server details</a>
</li>

<li>
<a href = 'configure_proxy.html'>Configure a Proxy</a>
</li>

<li>
<a href = 'performance_tuning.html'>Performance Tuning</a>
</li>
</ul>
</li>

<li>
<div>Using Go</div>

<ul>
<li>
<a href = 'quick_pipeline_setup.html'>Setup a new pipeline</a>
</li>

<li>
<a href = 'managing_pipelines.html'>Managing pipelines</a>
</li>

<li>
<a href = 'managing_a_build_cloud.html'>Managing agents</a>
</li>

<li>
<a href = 'managing_artifacts_and_reports.html'>Managing artifacts and reports</a>
</li>

<li>
<a href = 'managing_dependencies.html'>Managing dependencies</a>
</li>

<li>
<a href = 'managing_environments.html'>Managing environments</a>
</li>

<li>
<a href = 'dev_authentication.html'>Setting up authentication</a>
</li>

<li>
<a href = 'managing_users.html'>Managing Users</a>
</li>

<li>
<a href = 'dev_notifications.html'>Notifications</a>
</li>

<li>
<a href = 'properties.html'>Properties</a>
</li>

<li>
<a href = 'build_labelling.html'>Pipeline Labelling</a>
</li>

<li>
<a href = 'compare_pipelines.html'>Compare Builds</a>
</li>

<li>
<a href = 'go_integration.html'>Integration with external tools</a>
</li>

<li>
<a href = 'ordering_of_pipelines.html'>Ordering of pipelines</a>
</li>

<li>
<a href = 'pipeline_scheduling.html'>Pipeline Scheduling</a>
</li>

<li>
<a href = 'gadgets.html'>Gadgets</a>
</li>

<li>
<a href = 'delete_artifacts.html'>Auto delete artifacts</a>
</li>

<li>
<a href = 'job_timeout.html'>Job Timeout</a>
</li>

<li>
<a href = 'stage_duration_chart.html'>Graphs</a>
</li>

<li>
<a href = 'stage_old_config.html'>Historical Configuration</a>
</li>

<li>
<a href = 'command_repository.html'>Command Repository</a>
</li>

<li>
<a href = 'concurrent_config_modifications.html'>Concurrent Modifications to Go's Configuration</a>
</li>

<li>
<a href = 'package_material.html'>Package Material</a>
</li>

<li>
<a href = 'plugin_user_guide.html'>Plugin User Guide</a>
</li>
</ul>
</li>

<li>
<div>Go Tour</div>

<ul>
<li>
<a href = 'Pipelines_Dashboard_page.html'>Pipelines Dashboard</a>
</li>

<li>
<a href = 'agents_page.html'>Agents</a>
</li>

<li>
<a href = 'pipeline_activity_page.html'>Pipeline Activity</a>
</li>

<li>
<a href = 'stage_details_page.html'>Stage Details</a>
</li>

<li>
<a href = 'job_details_page.html'>Job Details</a>
</li>

<li>
<a href = 'administration_page.html'>Administration</a>
</li>

<li>
<a href = 'server_details_page.html'>Server Details</a>
</li>

<li>
<a href = 'environments_page.html'>Environments</a>
</li>

<li>
<a href = 'value_stream_map.html'>Value Stream Map</a>
</li>
</ul>
</li>

<li>
<div>As a Developer, I want to...</div>

<ul>
<li>
<a href = 'Pipelines_Dashboard_page.html'>...watch what's currently building</a>
</li>

<li>
<a href = 'trigger_with_options.html'>...trigger a pipeline with a different revision of material</a>
</li>

<li>
<a href = 'dev_notifications.html'>...be notified when I break the build</a>
</li>

<li>
<a href = 'dev_understand_why_build_broken.html'>...understand why the build is broken</a>
</li>

<li>
<a href = 'dev_see_artifact_as_tab.html'>...see my artifacts as a sub-tab on the Job Details page</a>
</li>

<li>
<a href = 'dev_save_properties.html'>...save properties about a build</a>
</li>

<li>
<a href = 'dev_clean_up_when_cancel.html'>...clean up my environment when I cancel a task</a>
</li>

<li>
<a href = 'dev_conditional_task_execution.html'>...only run a task when the build has failed</a>
</li>

<li>
<a href = 'dev_use_current_revision_in_build.html#current'>...use the current revision in my build</a>
</li>
</ul>
</li>

<li>
<div>As a Tester, I want to...</div>

<ul>
<li>
<a href = 'rm_deploy_to_environment.html#deploy_uat'>...release something into my UAT environment</a>
</li>

<li>
<a href = 'tester_what_has_changed.html'>...know what has changed in my new binary</a>
</li>

<li>
<a href = 'dependency_management.html'>...ensure appropriate tests are run against new builds</a>
</li>
</ul>
</li>

<li>
<div>As a Release Manager, I want to...</div>

<ul>
<li>
<a href = 'rm_deploy_to_environment.html#deploy_prod'>...release something into production</a>
</li>

<li>
<a href = 'rm_what_is_deployed.html'>...know what's currently in production</a>
</li>

<li>
<a href = 'deploy_a_specific_build_to_an_environment.html'>...deploy a specific build to production</a>
</li>

<li>
<a href = 'managing_environments.html'>...manage my environments</a>
</li>
</ul>
</li>

<li>
<div>As a Go Administrator, I want to...</div>

<ul>
<li>
<a href = 'pipeline_templates.html'>...template my pipelines</a>
</li>

<li>
<a href = 'admin_use_parameters_in_configuration.html'>...parameterize my pipelines</a>
</li>

<li>
<a href = 'installing_go_agent.html'>...install a new agent</a>
</li>

<li>
<a href = 'agent_auto_register.html'>...auto register a remote agent</a>
</li>

<li>
<a href = 'agent_guid_issue.html'>...clone/copy existing agents</a>
</li>

<li>
<a href = 'admin_install_multiple_agents.html'>...install multiple agents on one machine</a>
</li>

<li>
<a href = 'agents_page.html#filter_agents'>...view and filter agents</a>
</li>

<li>
<a href = 'quick_pipeline_setup.html'>...add a new pipeline</a>
</li>

<li>
<a href = 'admin_add_material.html'>...add a new  material to an existing pipeline</a>
</li>

<li>
<a href = 'admin_add_stage.html'>...add a new stage to an existing pipeline</a>
</li>

<li>
<a href = 'admin_add_job.html'>...add a new job to an existing stage</a>
</li>

<li>
<a href = 'admin_run_on_all_agents.html'>...run the same job on a group of agents</a>
</li>

<li>
<a href = 'dev_use_current_revision_in_build.html#job'>...pass environment variables to jobs</a>
</li>

<li>
<a href = 'admin_lock_pipelines.html'>...ensure only one instance of a pipeline can run at the same time</a>
</li>

<li>
<a href = 'dev_choose_when_stage_runs.html'>...choose when a certain stage runs</a>
</li>

<li>
<a href = 'admin_use_custom_pipeline_label.html'>...use a custom pipeline label</a>
</li>

<li>
<a href = 'managing_dependencies.html'>...manage my dependent pipelines</a>
</li>

<li>
<a href = 'dev_authentication.html'>...enable authentication on my Go server</a>
</li>

<li>
<a href = 'dev_authentication.html#ldap_authentication'>..configure LDAP access for my Go server</a>
</li>

<li>
<a href = 'dev_authorization.html'>...change permissions for different actions</a>
</li>

<li>
<a href = 'dev_authorization.html#pipeline-groups'>...ensure only certain users can see a group of pipelines</a>
</li>

<li>
<a href = 'dev_upload_test_report.html'>...publish reports and artifacts</a>
</li>

<li>
<a href = 'ui_testing.html'>...configure an agent to run UI tests</a>
</li>

<li>
<a href = 'admin_mailhost_info.html'>...add mailhost information to support email notifications</a>
</li>

<li>
<a href = 'admin_out_of_disk_space.html'>...clean up old artifacts when running out of disk space</a>
</li>

<li>
<a href = 'admin_timer.html'>...run a pipeline on a schedule</a>
</li>

<li>
<a href = 'managing_a_build_cloud.html#pausing_agent'>...pause an agent</a>
</li>

<li>
<a href = 'agent_details.html#identifying_environment_issues'>...see if a job fails because of an environment issue</a>
</li>

<li>
<a href = 'delegating_group_administration.html'>...delegating group administration</a>
</li>

<li>
<a href = 'one_click_backup.html'>...backup Go server</a>
</li>

<li>
<a href = 'material_update_hung.html'>...be notified when Go server is not able to poll for changes</a>
</li>
</ul>
</li>

<li>
<div>Mingle Integration</div>

<ul>
<li>
<a href = 'mingle_in_go.html'>Displaying Mingle gadgets in Go</a>
</li>

<li>
<a href = 'mingle_card_activity_gadget.html'>Mingle Card Activity Gadget</a>
</li>
</ul>
</li>

<li>
<a href = 'http://support.thoughtworks.com/categories/20002778-go-community-support'>FAQ/Troubleshooting</a>
</li>

<li>
<a href = 'go_api.html'>Go API</a>

<ul>
<li>
<a href = 'Artifacts_API.html'>Artifacts API</a>
</li>

<li>
<a href = 'Properties_API.html'>Properties API</a>
</li>

<li>
<a href = 'Configuration_API.html'>Configuration API</a>
</li>

<li>
<a href = 'Pipeline_API.html'>Pipeline API</a>
</li>

<li>
<a href = 'Stages_API.html'>Stages API</a>
</li>

<li>
<a href = 'command_repo_api.html'>Command Repo API</a>
</li>

<li>
<a href = 'Agent_API.html'>Agent API</a>
</li>

<li>
<a href = 'Feeds_API.html'>Feeds API</a>
</li>

<li>
<a href = 'Backup_API.html'>Backup API</a>
</li>

<li>
<a href = 'materials_api.html'>Materials API</a>
</li>

<li>
<a href = 'users_api.html'>Users API</a>
</li>
</ul>
</li>

<li>
<div>Extension Points of Go</div>

<ul>
<li>
<a href = 'go_plugins_basics.html'>Plugins in Go</a>
</li>

<li>
<a href = 'resources/javadoc/index.html' target = '_blank'>Go Plugin API</a>
</li>

<li>
<a href = 'writing_go_package_material_plugin.html'>Writing a package material plugin</a>
</li>
</ul>
</li>

<li>
<div>Bundled Plugins</div>

<ul>
<li>
<a href = 'yum_repository_poller.html'>Yum Repository Poller</a>
</li>
</ul>
</li>

<li>
<div>Configuration</div>

<ul>
<li>
<a href = 'configuration_reference.html'>Configuration Reference</a>
</li>

<li>
<a href = 'schema.html'>Schema</a>
</li>
</ul>
</li>
</ul>
</div>

<div id = 'ft' class = 'footer'>&copy; ThoughtWorks Studios, 2010</div>
</body>
</html>
